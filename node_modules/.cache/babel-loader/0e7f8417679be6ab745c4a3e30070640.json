{"ast":null,"code":"import _toConsumableArray from\"/Users/mohamed/uix-cloudinary-input/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/mohamed/uix-cloudinary-input/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/mohamed/uix-cloudinary-input/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useLayoutEffect,useState,useEffect}from'react';import{Image,Video,Placeholder}from'cloudinary-react';import{Route,Switch,BrowserRouter}from'react-router-dom';import{Wrapper as ExtensionWrapper,useUiExtensionDialog,useFieldExtension,FieldExtensionType,FieldExtensionFeature,ExtensionType,ConfigType}from'@graphcms/uix-react-sdk';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function isMediaType(item){return Boolean(item)&&'public_id'in item&&'resource_type'in item;}function isMediaList(media){return Array.isArray(media)&&media.length>0&&media.every(function(item){return isMediaType(item);});}// useUiExtensionDialog hook accepts two type parameters:\n// 1. The return value type, will be null or undefined if nothing is returned; falls back to any\nvar declaration={extensionType:ExtensionType.field,fieldType:FieldExtensionType.JSON,name:'Cloudinary asset',description:'Pick asset object in Cloudinary',features:[// Enables rendering of a form field\nFieldExtensionFeature.FieldRenderer,// Enables handling lists of values\n// Don't forget to enable multiple values when creating a UI extension field in Hygraph!\nFieldExtensionFeature.ListRenderer,// Enables rendering in content table view\nFieldExtensionFeature.TableRenderer],// Optional fields that will when adding or updating a UI extension in Hygraph\nconfig:{CLOUD_NAME:{displayName:'Cloudinary cloud name',type:ConfigType.string,required:true},API_KEY:{displayName:'Cloudinary public api key',type:ConfigType.string,required:true}}};function noop(){}// Treat the dialog as a separate extension and render it at a dedicated route\n// The dialog path you set here should later be passed as the first argument to the openDialog function\nfunction App(){return/*#__PURE__*/_jsx(ExtensionWrapper,{declaration:declaration,children:/*#__PURE__*/_jsx(BrowserRouter,{children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,children:/*#__PURE__*/_jsx(Extension,{})}),/*#__PURE__*/_jsx(Route,{path:\"/cloudinary\",exact:true,children:/*#__PURE__*/_jsx(CloudinaryDialog,{})})]})})});}function Extension(){var _useFieldExtension=useFieldExtension(),isTableCell=_useFieldExtension.isTableCell;// isTableCell can be used to detect whether the extension is currently rendered in content table\nif(isTableCell){return/*#__PURE__*/_jsx(TableCellRenderer,{});}return/*#__PURE__*/_jsx(FormFieldRenderer,{});}function FormFieldRenderer(){var _useFieldExtension2=useFieldExtension(),media=_useFieldExtension2.value,isList=_useFieldExtension2.field.isList,onChange=_useFieldExtension2.onChange,onFocus=_useFieldExtension2.onFocus,onBlur=_useFieldExtension2.onBlur,expand=_useFieldExtension2.expand,isExpanded=_useFieldExtension2.isExpanded,openDialog=_useFieldExtension2.openDialog,config=_useFieldExtension2.extension.config;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isTransitioning=_useState2[0],setIsTransitioning=_useState2[1];useEffect(function(){setIsTransitioning(false);},[isExpanded]);var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),clickedMedia=_React$useState2[0],setClickedMedia=_React$useState2[1];// Note that in a form, an empty field's initial value is an empty string\nvar showMedia=Array.isArray(media)?media.length>0:Boolean(media);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'flex-start',padding:'10px',opacity:isTransitioning?0:1},children:[isExpanded?null:/*#__PURE__*/_jsx(\"button\",{style:{cursor:'pointer',marginBottom:'10px',boxSizing:'border-box',userSelect:'none',color:'#6663FD',backgroundColor:'#F2F1FF',textAlign:'center',lineHeight:'16px',display:'inline-flex',border:'0px',borderRadius:'4px',fontWeight:600,fontFamily:'Inter, -apple-system, system-ui, \"Segoe UI\", Helvetica, Arial, sans-serif',fontSize:'14px',verticalAlign:'middle',padding:'8px'},onClick:function onClick(){onFocus();// openDialog accepts a route path as the first argument and,\n// optionally, an object with props that will be passed to the dialog.\n// These props will be returned by the useUiExtensionDialog hook\n//\nopenDialog('/cloudinary',{// By default, native Hygraph dialogs have a maxWidth of 600px.\n// You can overwrite it by passing a maxWidth prop\nmaxWidth:'90vw',isList:isList,media:media// openDialog returns a Promise with the value that was passed to onCloseDialog\n}).then(function(value){if(value){onChange(value);}onBlur();});},children:\"Choose from Cloudinary\"}),showMedia&&(isMediaList(media)?media.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'row',alignItems:'flex-start',opacity:isExpanded&&item.public_id!==(clickedMedia===null||clickedMedia===void 0?void 0:clickedMedia.public_id)?0:1},children:[/*#__PURE__*/_jsx(FormAsset,{cloudName:String(config.CLOUD_NAME),media:item,isExpanded:item.public_id===(clickedMedia===null||clickedMedia===void 0?void 0:clickedMedia.public_id)&&isExpanded,onOpen:function onOpen(){// expand accepts a boolean that will be accessible as isExpanded\nexpand(true);setIsTransitioning(true);setClickedMedia(item);},onClose:function onClose(){expand(false);setIsTransitioning(true);setClickedMedia(undefined);}}),/*#__PURE__*/_jsx(\"button\",{style:{marginLeft:'10px',cursor:'pointer',boxSizing:'border-box',userSelect:'none',color:'#6663FD',backgroundColor:'transparent',textAlign:'center',lineHeight:'14px',display:'inline-flex',border:'0px',fontWeight:500,fontFamily:'sans-serif',fontSize:'12px',verticalAlign:'middle',padding:'4px'},onClick:function onClick(){var newValues=media.filter(function(value){return value.public_id!==item.public_id;});onChange(newValues);},children:\"X\"})]},item.public_id+index);}):/*#__PURE__*/_jsx(FormAsset,{cloudName:String(config.CLOUD_NAME),isExpanded:media.public_id===(clickedMedia===null||clickedMedia===void 0?void 0:clickedMedia.public_id)&&isExpanded,onOpen:function onOpen(){expand(true);setIsTransitioning(true);setClickedMedia(media);},onClose:function onClose(){expand(false);setIsTransitioning(true);setClickedMedia(undefined);},media:media}))]});}function TableCellRenderer(){var _useFieldExtension3=useFieldExtension(),media=_useFieldExtension3.value,isExpanded=_useFieldExtension3.isExpanded,expand=_useFieldExtension3.expand,isList=_useFieldExtension3.field.isList,config=_useFieldExtension3.extension.config;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isTransitioning=_useState4[0],setIsTransitioning=_useState4[1];useEffect(function(){setIsTransitioning(false);},[isExpanded]);if(Array.isArray(media)?media.length===0:Boolean(media)===false){return null;}if(isExpanded&&isList){return/*#__PURE__*/_jsx(TableAssetsPreviewModal,{cloudName:String(config.CLOUD_NAME),media:media,closeModal:function closeModal(){expand(false);setIsTransitioning(true);}});}return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',opacity:isTransitioning?0:1},children:isMediaList(media)?media.map(function(item,index){return/*#__PURE__*/_jsx(\"div\",{style:{width:59,height:59,marginRight:index===media.length-1?0:10},children:/*#__PURE__*/_jsx(TableAsset,{cloudName:String(config.CLOUD_NAME),media:item,onOpen:function onOpen(){expand(true);setIsTransitioning(true);},isExpanded:false,onClose:noop})},item.public_id+index);}):/*#__PURE__*/_jsx(\"div\",{style:{width:59,height:59},children:/*#__PURE__*/_jsx(TableAsset,{cloudName:String(config.CLOUD_NAME),isExpanded:isExpanded,onClose:function onClose(){expand(false);setIsTransitioning(true);},onOpen:function onOpen(){expand(true);setIsTransitioning(true);},media:media})})});}function FormAsset(_ref){var media=_ref.media,onOpen=_ref.onOpen,onClose=_ref.onClose,isExpanded=_ref.isExpanded,cloudName=_ref.cloudName;if(isExpanded){return/*#__PURE__*/_jsx(FullScreenPreview,{cloudName:cloudName,media:media,onClose:onClose});}if(media.resource_type==='image')return/*#__PURE__*/_jsx(\"button\",{onClick:onOpen,style:{border:'none',outline:'none',background:'transparent',cursor:'pointer'},children:/*#__PURE__*/_jsx(Image,{cloudName:cloudName,publicId:media.public_id,width:\"400\",crop:\"scale\",children:/*#__PURE__*/_jsx(Placeholder,{})})});if(media.resource_type==='video')return/*#__PURE__*/_jsx(Video,{cloudName:cloudName,publicId:media.public_id,width:\"400\",controls:true});return null;}function TableAsset(_ref2){var isExpanded=_ref2.isExpanded,media=_ref2.media,onOpen=_ref2.onOpen,onClose=_ref2.onClose,cloudName=_ref2.cloudName,style=_ref2.style;if(isExpanded){return/*#__PURE__*/_jsx(FullScreenPreview,{media:media,onClose:onClose,cloudName:cloudName});}return/*#__PURE__*/_jsx(\"div\",{tabIndex:0,onClick:onOpen,onKeyPress:function onKeyPress(e){if(e.key==='Enter'){onOpen();}},style:_objectSpread({width:59,height:59,flexShrink:0},style),children:media.resource_type==='image'?/*#__PURE__*/_jsx(Image,{publicId:media.public_id,cloudName:cloudName,width:\"auto\",crop:\"scale\",style:{objectFit:'cover',width:'100%',height:'100%',cursor:'pointer'},children:/*#__PURE__*/_jsx(Placeholder,{})}):media.resource_type==='video'?/*#__PURE__*/_jsx(Video,{cloudName:cloudName,publicId:media.public_id,width:\"auto\",style:{objectFit:'cover',width:'100%',height:'100%',cursor:'pointer'}}):null});}function TableAssetsPreviewModal(_ref3){var closeModal=_ref3.closeModal,media=_ref3.media,cloudName=_ref3.cloudName;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),maximizedAsset=_useState6[0],setMaximizedAsset=_useState6[1];if(maximizedAsset){return/*#__PURE__*/_jsx(TableAsset,{cloudName:cloudName,media:maximizedAsset,isExpanded:true,onOpen:noop,onClose:function onClose(){setMaximizedAsset(null);}});}return/*#__PURE__*/_jsx(\"div\",{\"aria-modal\":\"true\",role:\"dialog\",style:{position:'fixed',inset:0,display:'flex'},onClick:closeModal,children:/*#__PURE__*/_jsxs(\"div\",{style:{margin:'auto'},onClick:function onClick(e){e.stopPropagation();},children:[/*#__PURE__*/_jsx(CloseModalButton,{closeModal:closeModal}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',borderRadius:'4px',backgroundColor:'white',maxWidth:'800px',maxHeight:'400px',padding:'16px',overflowY:'auto'},children:media.map(function(item,index){return/*#__PURE__*/_jsx(TableAsset,{isExpanded:false,cloudName:cloudName,media:item,onOpen:function onOpen(){setMaximizedAsset(item);},onClose:function onClose(){setMaximizedAsset(null);},style:{width:250,height:200,marginRight:index===media.length-1?0:16}},item.public_id+index);})})]})});}function FullScreenPreview(_ref4){var media=_ref4.media,cloudName=_ref4.cloudName,onClose=_ref4.onClose;useEffect(function(){var handler=function handler(e){if(e.key==='Escape'){onClose();}};window.addEventListener('keyup',handler);return function(){window.removeEventListener('keyup',handler);};},[onClose]);return/*#__PURE__*/_jsxs(\"div\",{\"aria-modal\":\"true\",role:\"dialog\",style:{position:'fixed',inset:0,display:'flex',alignItems:'center',overflow:'auto'},onClick:function onClick(e){e.stopPropagation();onClose();},children:[/*#__PURE__*/_jsx(CloseModalButton,{closeModal:onClose}),media.resource_type==='image'?/*#__PURE__*/_jsx(Image,{cloudName:cloudName,publicId:media.public_id,width:\"auto\",style:{maxWidth:'100%',margin:'auto',maxHeight:'100%'},crop:\"scale\",children:/*#__PURE__*/_jsx(Placeholder,{})}):media.resource_type==='video'?/*#__PURE__*/_jsx(Video,{cloudName:cloudName,publicId:media.public_id,controls:true,style:{maxWidth:'70vw',margin:'auto',maxHeight:'100%'}}):null]});}function CloudinaryDialog(){var _useFieldExtension4=useFieldExtension(),config=_useFieldExtension4.extension.config;// You can pass type parameters to useUiExtensionDialog\n// onCloseDialog function is always returned from the hook\nvar _useUiExtensionDialog=useUiExtensionDialog(),onCloseDialog=_useUiExtensionDialog.onCloseDialog,isList=_useUiExtensionDialog.isList,media=_useUiExtensionDialog.media;useLayoutEffect(function(){// @ts-expect-error\nvar mediaLibrary=window.cloudinary.createMediaLibrary({cloud_name:config.CLOUD_NAME,api_key:config.API_KEY,remove_header:false,max_files:'10',multiple:isList,insert_caption:'Add & close',inline_container:'#cloudinary_dialog',default_transformations:[[{quality:'auto'},{fetch_format:'auto'}],[{width:80,height:80,crop:'fill',gravity:'auto',radius:'max'},{fetch_format:'auto',quality:'auto'}]],integration:{type:'hygraph_cloudinary_extension',platform:'hygraph',version:1.0,environment:'prod'}},{hideHandler:function hideHandler(){// To close the dialog without returning a value to the fields,\n// call onCloseDialog with null or without an argument\nonCloseDialog();},insertHandler:function insertHandler(data){// Pass a single value to onCloseDialog to set it as the field value\n// or an array, if the field handles multiple values\nif(isList){if(isMediaList(media)){onCloseDialog([].concat(_toConsumableArray(media),_toConsumableArray(data.assets)));}else{// initial field value is an empty string\nvar newArray=isMediaType(media)?[media].concat(_toConsumableArray(data.assets)):data.assets;onCloseDialog(newArray);}}else{onCloseDialog(data.assets[0]);}}});mediaLibrary.show();},[config.API_KEY,config.CLOUD_NAME,isList,media,onCloseDialog]);return/*#__PURE__*/_jsx(\"div\",{id:\"cloudinary_dialog\",style:{height:'800px'}});}function CloseModalButton(_ref5){var closeModal=_ref5.closeModal;return/*#__PURE__*/_jsx(\"button\",{type:\"button\",style:{cursor:'pointer',userSelect:'none',backgroundColor:'transparent',textAlign:'center',lineHeight:'16px',display:'inline-flex',border:'0px',position:'absolute',right:'10px',top:'10px',fontWeight:500,background:'white',color:'black',fontSize:'16px',borderRadius:'4px',padding:'4px 8px',verticalAlign:'middle',margin:0},onClick:function onClick(event){event.preventDefault();event.stopPropagation();closeModal();},onKeyPress:function onKeyPress(event){event.preventDefault();event.stopPropagation();if(event.key==='Enter'){closeModal();}},children:\"Close\"});}export default App;","map":{"version":3,"sources":["/Users/mohamed/uix-cloudinary-input/src/App.tsx"],"names":["React","useLayoutEffect","useState","useEffect","Image","Video","Placeholder","Route","Switch","BrowserRouter","Wrapper","ExtensionWrapper","useUiExtensionDialog","useFieldExtension","FieldExtensionType","FieldExtensionFeature","ExtensionType","ConfigType","isMediaType","item","Boolean","isMediaList","media","Array","isArray","length","every","declaration","extensionType","field","fieldType","JSON","name","description","features","FieldRenderer","ListRenderer","TableRenderer","config","CLOUD_NAME","displayName","type","string","required","API_KEY","noop","App","Extension","isTableCell","FormFieldRenderer","value","isList","onChange","onFocus","onBlur","expand","isExpanded","openDialog","extension","isTransitioning","setIsTransitioning","clickedMedia","setClickedMedia","showMedia","display","flexDirection","alignItems","padding","opacity","cursor","marginBottom","boxSizing","userSelect","color","backgroundColor","textAlign","lineHeight","border","borderRadius","fontWeight","fontFamily","fontSize","verticalAlign","maxWidth","then","map","index","public_id","String","undefined","marginLeft","newValues","filter","TableCellRenderer","width","height","marginRight","FormAsset","onOpen","onClose","cloudName","resource_type","outline","background","TableAsset","style","e","key","flexShrink","objectFit","TableAssetsPreviewModal","closeModal","maximizedAsset","setMaximizedAsset","position","inset","margin","stopPropagation","maxHeight","overflowY","FullScreenPreview","handler","window","addEventListener","removeEventListener","overflow","CloudinaryDialog","onCloseDialog","mediaLibrary","cloudinary","createMediaLibrary","cloud_name","api_key","remove_header","max_files","multiple","insert_caption","inline_container","default_transformations","quality","fetch_format","crop","gravity","radius","integration","platform","version","environment","hideHandler","insertHandler","data","assets","newArray","show","CloseModalButton","right","top","event","preventDefault"],"mappings":"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","sourcesContent":["import React, { useLayoutEffect, useState, useEffect } from 'react';\nimport { Image, Video, Placeholder } from 'cloudinary-react';\nimport { Route, Switch, BrowserRouter } from 'react-router-dom';\nimport {\n  Wrapper as ExtensionWrapper,\n  useUiExtensionDialog,\n  useFieldExtension,\n  FieldExtensionType,\n  FieldExtensionFeature,\n  FieldExtensionDeclaration,\n  ExtensionType,\n  ConfigType,\n} from '@graphcms/uix-react-sdk';\n\ntype Media = {\n  public_id: string;\n  resource_type: string;\n};\n\nfunction isMediaType(item: any): item is Media {\n  return Boolean(item) && 'public_id' in item && 'resource_type' in item;\n}\nfunction isMediaList(media: Media | Media[] | string): media is Media[] {\n  return (\n    Array.isArray(media) &&\n    media.length > 0 &&\n    media.every((item) => isMediaType(item))\n  );\n}\n// useUiExtensionDialog hook accepts two type parameters:\n// 1. The return value type, will be null or undefined if nothing is returned; falls back to any\ntype DialogReturn = Media | Media[] | null;\n// 2. Optional props you'd like to access in the dialog\ntype DialogProps = { isList: boolean; media: Media | Media[] | '' };\n\nconst declaration: FieldExtensionDeclaration = {\n  extensionType: ExtensionType.field,\n  fieldType: FieldExtensionType.JSON,\n  name: 'Cloudinary asset',\n  description: 'Pick asset object in Cloudinary',\n  features: [\n    // Enables rendering of a form field\n    FieldExtensionFeature.FieldRenderer,\n    // Enables handling lists of values\n    // Don't forget to enable multiple values when creating a UI extension field in Hygraph!\n    FieldExtensionFeature.ListRenderer,\n    // Enables rendering in content table view\n    FieldExtensionFeature.TableRenderer,\n  ],\n  // Optional fields that will when adding or updating a UI extension in Hygraph\n  config: {\n    CLOUD_NAME: {\n      displayName: 'Cloudinary cloud name',\n      type: ConfigType.string,\n      required: true,\n    },\n    API_KEY: {\n      displayName: 'Cloudinary public api key',\n      type: ConfigType.string,\n      required: true,\n    },\n  },\n};\n\nfunction noop() {}\n\n// Treat the dialog as a separate extension and render it at a dedicated route\n// The dialog path you set here should later be passed as the first argument to the openDialog function\nfunction App() {\n  return (\n    <ExtensionWrapper declaration={declaration}>\n      <BrowserRouter>\n        <Switch>\n          <Route path=\"/\" exact>\n            <Extension />\n          </Route>\n          <Route path=\"/cloudinary\" exact>\n            <CloudinaryDialog />\n          </Route>\n        </Switch>\n      </BrowserRouter>\n    </ExtensionWrapper>\n  );\n}\n\nfunction Extension() {\n  const { isTableCell } = useFieldExtension();\n  // isTableCell can be used to detect whether the extension is currently rendered in content table\n  if (isTableCell) {\n    return <TableCellRenderer />;\n  }\n\n  return <FormFieldRenderer />;\n}\n\nfunction FormFieldRenderer() {\n  const {\n    value: media,\n    // field.isList reveals whether a field handles multiple values\n    field: { isList },\n    onChange,\n    onFocus,\n    onBlur,\n    // expand opens a full-screen view\n    expand,\n    isExpanded,\n    openDialog,\n    extension: { config },\n  } = useFieldExtension();\n\n  const [isTransitioning, setIsTransitioning] = useState(false);\n\n  useEffect(() => {\n    setIsTransitioning(false);\n  }, [isExpanded]);\n\n  const [clickedMedia, setClickedMedia] = React.useState<Media>();\n  // Note that in a form, an empty field's initial value is an empty string\n  const showMedia = Array.isArray(media) ? media.length > 0 : Boolean(media);\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'flex-start',\n        padding: '10px',\n        opacity: isTransitioning ? 0 : 1,\n      }}\n    >\n      {isExpanded ? null : (\n        <button\n          style={{\n            cursor: 'pointer',\n            marginBottom: '10px',\n            boxSizing: 'border-box',\n            userSelect: 'none',\n            color: '#6663FD',\n            backgroundColor: '#F2F1FF',\n            textAlign: 'center',\n            lineHeight: '16px',\n            display: 'inline-flex',\n            border: '0px',\n            borderRadius: '4px',\n            fontWeight: 600,\n            fontFamily:\n              'Inter, -apple-system, system-ui, \"Segoe UI\", Helvetica, Arial, sans-serif',\n            fontSize: '14px',\n            verticalAlign: 'middle',\n            padding: '8px',\n          }}\n          onClick={() => {\n            onFocus();\n            // openDialog accepts a route path as the first argument and,\n            // optionally, an object with props that will be passed to the dialog.\n            // These props will be returned by the useUiExtensionDialog hook\n            //\n            openDialog<DialogReturn, DialogProps>('/cloudinary', {\n              // By default, native Hygraph dialogs have a maxWidth of 600px.\n              // You can overwrite it by passing a maxWidth prop\n              maxWidth: '90vw',\n              isList,\n              media,\n              // openDialog returns a Promise with the value that was passed to onCloseDialog\n            }).then((value) => {\n              if (value) {\n                onChange(value);\n              }\n              onBlur();\n            });\n          }}\n        >\n          Choose from Cloudinary\n        </button>\n      )}\n      {showMedia &&\n        (isMediaList(media) ? (\n          media.map((item, index) => (\n            <div\n              style={{\n                display: 'flex',\n                flexDirection: 'row',\n                alignItems: 'flex-start',\n                opacity:\n                  isExpanded && item.public_id !== clickedMedia?.public_id\n                    ? 0\n                    : 1,\n              }}\n              key={item.public_id + index}\n            >\n              <FormAsset\n                cloudName={String(config.CLOUD_NAME)}\n                media={item}\n                isExpanded={\n                  item.public_id === clickedMedia?.public_id && isExpanded\n                }\n                onOpen={() => {\n                  // expand accepts a boolean that will be accessible as isExpanded\n                  expand(true);\n                  setIsTransitioning(true);\n                  setClickedMedia(item);\n                }}\n                onClose={() => {\n                  expand(false);\n                  setIsTransitioning(true);\n                  setClickedMedia(undefined);\n                }}\n              />\n              <button\n                style={{\n                  marginLeft: '10px',\n                  cursor: 'pointer',\n                  boxSizing: 'border-box',\n                  userSelect: 'none',\n                  color: '#6663FD',\n                  backgroundColor: 'transparent',\n                  textAlign: 'center',\n                  lineHeight: '14px',\n                  display: 'inline-flex',\n                  border: '0px',\n                  fontWeight: 500,\n                  fontFamily: 'sans-serif',\n                  fontSize: '12px',\n                  verticalAlign: 'middle',\n                  padding: '4px',\n                }}\n                onClick={() => {\n                  const newValues = media.filter(\n                    (value) => value.public_id !== item.public_id\n                  );\n                  onChange(newValues);\n                }}\n              >\n                X\n              </button>\n            </div>\n          ))\n        ) : (\n          <FormAsset\n            cloudName={String(config.CLOUD_NAME)}\n            isExpanded={\n              media.public_id === clickedMedia?.public_id && isExpanded\n            }\n            onOpen={() => {\n              expand(true);\n              setIsTransitioning(true);\n              setClickedMedia(media);\n            }}\n            onClose={() => {\n              expand(false);\n              setIsTransitioning(true);\n              setClickedMedia(undefined);\n            }}\n            media={media}\n          />\n        ))}\n    </div>\n  );\n}\n\nfunction TableCellRenderer() {\n  const {\n    value: media,\n    isExpanded,\n    expand,\n    field: { isList },\n    extension: { config },\n  } = useFieldExtension();\n\n  const [isTransitioning, setIsTransitioning] = useState(false);\n\n  useEffect(() => {\n    setIsTransitioning(false);\n  }, [isExpanded]);\n\n  if (Array.isArray(media) ? media.length === 0 : Boolean(media) === false) {\n    return null;\n  }\n\n  if (isExpanded && isList) {\n    return (\n      <TableAssetsPreviewModal\n        cloudName={String(config.CLOUD_NAME)}\n        media={media}\n        closeModal={() => {\n          expand(false);\n          setIsTransitioning(true);\n        }}\n      />\n    );\n  }\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        opacity: isTransitioning ? 0 : 1,\n      }}\n    >\n      {isMediaList(media) ? (\n        media.map((item: Media, index: number) => (\n          <div\n            key={item.public_id + index}\n            style={{\n              width: 59,\n              height: 59,\n              marginRight: index === media.length - 1 ? 0 : 10,\n            }}\n          >\n            <TableAsset\n              cloudName={String(config.CLOUD_NAME)}\n              media={item}\n              onOpen={() => {\n                expand(true);\n                setIsTransitioning(true);\n              }}\n              isExpanded={false}\n              onClose={noop}\n            />\n          </div>\n        ))\n      ) : (\n        <div style={{ width: 59, height: 59 }}>\n          <TableAsset\n            cloudName={String(config.CLOUD_NAME)}\n            isExpanded={isExpanded}\n            onClose={() => {\n              expand(false);\n              setIsTransitioning(true);\n            }}\n            onOpen={() => {\n              expand(true);\n              setIsTransitioning(true);\n            }}\n            media={media}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction FormAsset({\n  media,\n  onOpen,\n  onClose,\n  isExpanded,\n  cloudName,\n}: {\n  style?: React.CSSProperties;\n  isExpanded: boolean;\n  media: Media;\n  onOpen: () => void;\n  onClose: () => void;\n  cloudName: string;\n}) {\n  if (isExpanded) {\n    return (\n      <FullScreenPreview\n        cloudName={cloudName}\n        media={media}\n        onClose={onClose}\n      />\n    );\n  }\n\n  if (media.resource_type === 'image')\n    return (\n      <button\n        onClick={onOpen}\n        style={{\n          border: 'none',\n          outline: 'none',\n          background: 'transparent',\n          cursor: 'pointer',\n        }}\n      >\n        <Image\n          cloudName={cloudName}\n          publicId={media.public_id}\n          width=\"400\"\n          crop=\"scale\"\n        >\n          <Placeholder />\n        </Image>\n      </button>\n    );\n\n  if (media.resource_type === 'video')\n    return (\n      <Video\n        cloudName={cloudName}\n        publicId={media.public_id}\n        width=\"400\"\n        controls\n      />\n    );\n\n  return null;\n}\n\nfunction TableAsset({\n  isExpanded,\n  media,\n  onOpen,\n  onClose,\n  cloudName,\n  style,\n}: {\n  style?: React.CSSProperties;\n  isExpanded: boolean;\n  media: Media;\n  onOpen: () => void;\n  onClose: () => void;\n  cloudName: string;\n}) {\n  if (isExpanded) {\n    return (\n      <FullScreenPreview\n        media={media}\n        onClose={onClose}\n        cloudName={cloudName}\n      />\n    );\n  }\n\n  return (\n    <div\n      tabIndex={0}\n      onClick={onOpen}\n      onKeyPress={(e) => {\n        if (e.key === 'Enter') {\n          onOpen();\n        }\n      }}\n      style={{\n        width: 59,\n        height: 59,\n        flexShrink: 0,\n        ...style,\n      }}\n    >\n      {media.resource_type === 'image' ? (\n        <Image\n          publicId={media.public_id}\n          cloudName={cloudName}\n          width=\"auto\"\n          crop=\"scale\"\n          style={{\n            objectFit: 'cover',\n            width: '100%',\n            height: '100%',\n            cursor: 'pointer',\n          }}\n        >\n          <Placeholder />\n        </Image>\n      ) : media.resource_type === 'video' ? (\n        <Video\n          cloudName={cloudName}\n          publicId={media.public_id}\n          width=\"auto\"\n          style={{\n            objectFit: 'cover',\n            width: '100%',\n            height: '100%',\n            cursor: 'pointer',\n          }}\n        />\n      ) : null}\n    </div>\n  );\n}\n\nfunction TableAssetsPreviewModal({\n  closeModal,\n  media,\n  cloudName,\n}: {\n  media: Media[];\n  closeModal: () => void;\n  cloudName: string;\n}) {\n  const [maximizedAsset, setMaximizedAsset] = useState<Media | null>(null);\n\n  if (maximizedAsset) {\n    return (\n      <TableAsset\n        cloudName={cloudName}\n        media={maximizedAsset}\n        isExpanded\n        onOpen={noop}\n        onClose={() => {\n          setMaximizedAsset(null);\n        }}\n      />\n    );\n  }\n\n  return (\n    <div\n      aria-modal=\"true\"\n      role=\"dialog\"\n      style={{\n        position: 'fixed',\n        inset: 0,\n        display: 'flex',\n      }}\n      onClick={closeModal}\n    >\n      <div\n        style={{ margin: 'auto' }}\n        onClick={(e) => {\n          e.stopPropagation();\n        }}\n      >\n        <CloseModalButton closeModal={closeModal} />\n        <div\n          style={{\n            display: 'flex',\n            borderRadius: '4px',\n            backgroundColor: 'white',\n            maxWidth: '800px',\n            maxHeight: '400px',\n            padding: '16px',\n            overflowY: 'auto',\n          }}\n        >\n          {media.map((item, index) => (\n            <TableAsset\n              isExpanded={false}\n              cloudName={cloudName}\n              media={item}\n              key={item.public_id + index}\n              onOpen={() => {\n                setMaximizedAsset(item);\n              }}\n              onClose={() => {\n                setMaximizedAsset(null);\n              }}\n              style={{\n                width: 250,\n                height: 200,\n                marginRight: index === media.length - 1 ? 0 : 16,\n              }}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction FullScreenPreview({\n  media,\n  cloudName,\n  onClose,\n}: {\n  media: Media;\n  onClose: () => void;\n  cloudName: string;\n}) {\n  useEffect(() => {\n    const handler = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n    window.addEventListener('keyup', handler);\n    return () => {\n      window.removeEventListener('keyup', handler);\n    };\n  }, [onClose]);\n\n  return (\n    <div\n      aria-modal=\"true\"\n      role=\"dialog\"\n      style={{\n        position: 'fixed',\n        inset: 0,\n        display: 'flex',\n        alignItems: 'center',\n        overflow: 'auto',\n      }}\n      onClick={(e) => {\n        e.stopPropagation();\n        onClose();\n      }}\n    >\n      <CloseModalButton closeModal={onClose} />\n      {media.resource_type === 'image' ? (\n        <Image\n          cloudName={cloudName}\n          publicId={media.public_id}\n          width=\"auto\"\n          style={{ maxWidth: '100%', margin: 'auto', maxHeight: '100%' }}\n          crop=\"scale\"\n        >\n          <Placeholder />\n        </Image>\n      ) : media.resource_type === 'video' ? (\n        <Video\n          cloudName={cloudName}\n          publicId={media.public_id}\n          controls\n          style={{ maxWidth: '70vw', margin: 'auto', maxHeight: '100%' }}\n        />\n      ) : null}\n    </div>\n  );\n}\n\nfunction CloudinaryDialog() {\n  const {\n    extension: { config },\n  } = useFieldExtension();\n  // You can pass type parameters to useUiExtensionDialog\n  // onCloseDialog function is always returned from the hook\n  const { onCloseDialog, isList, media } = useUiExtensionDialog<\n    DialogReturn,\n    DialogProps\n  >();\n  useLayoutEffect(() => {\n    // @ts-expect-error\n    const mediaLibrary = window.cloudinary.createMediaLibrary(\n      {\n        cloud_name: config.CLOUD_NAME,\n        api_key: config.API_KEY,\n        remove_header: false,\n        max_files: '10',\n        multiple: isList,\n        insert_caption: 'Add & close',\n        inline_container: '#cloudinary_dialog',\n        default_transformations: [\n          [{ quality: 'auto' }, { fetch_format: 'auto' }],\n          [\n            {\n              width: 80,\n              height: 80,\n              crop: 'fill',\n              gravity: 'auto',\n              radius: 'max',\n            },\n            { fetch_format: 'auto', quality: 'auto' },\n          ],\n        ],\n        integration: {\n          type: 'hygraph_cloudinary_extension',\n          platform: 'hygraph',\n          version: 1.0,\n          environment: 'prod',\n        },\n      },\n      {\n        hideHandler: function () {\n          // To close the dialog without returning a value to the fields,\n          // call onCloseDialog with null or without an argument\n          onCloseDialog();\n        },\n        insertHandler: function (data: { assets: Media[] }) {\n          // Pass a single value to onCloseDialog to set it as the field value\n          // or an array, if the field handles multiple values\n          if (isList) {\n            if (isMediaList(media)) {\n              onCloseDialog([...media, ...data.assets]);\n            } else {\n              // initial field value is an empty string\n              const newArray = isMediaType(media)\n                ? [media, ...data.assets]\n                : data.assets;\n              onCloseDialog(newArray);\n            }\n          } else {\n            onCloseDialog(data.assets[0]);\n          }\n        },\n      }\n    );\n    mediaLibrary.show();\n  }, [config.API_KEY, config.CLOUD_NAME, isList, media, onCloseDialog]);\n\n  return (\n    <div\n      id=\"cloudinary_dialog\"\n      style={{\n        height: '800px',\n      }}\n    />\n  );\n}\n\nfunction CloseModalButton({ closeModal }: { closeModal: () => void }) {\n  return (\n    <button\n      type=\"button\"\n      style={{\n        cursor: 'pointer',\n        userSelect: 'none',\n        backgroundColor: 'transparent',\n        textAlign: 'center',\n        lineHeight: '16px',\n        display: 'inline-flex',\n        border: '0px',\n        position: 'absolute',\n        right: '10px',\n        top: '10px',\n        fontWeight: 500,\n        background: 'white',\n        color: 'black',\n        fontSize: '16px',\n        borderRadius: '4px',\n        padding: '4px 8px',\n        verticalAlign: 'middle',\n        margin: 0,\n      }}\n      onClick={(event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        closeModal();\n      }}\n      onKeyPress={(event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (event.key === 'Enter') {\n          closeModal();\n        }\n      }}\n    >\n      Close\n    </button>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}